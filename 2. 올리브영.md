- 명기현 솔루션즈 아키텍트, AWS

# eCommerce 현대화
- 이커머스 트렌드 ; 리더들이 생각하는 성공의 우선순위
- 이커머스 현대화
  - 도메인 기반 설계 : 모놀리 -> 마이크로 domain-driven
  - 이벤트 기반 아키텍처 event-driven
  - **목적별 데이터베이스** purpose-built database
 
# 도메인 기반 설계
- 이커머스 애플리케이션
- 통신 및 의존성 (직접 호출 - 화이트 박스식 ; 오류 확장되는 등의 문제)
- 주문 재고 검색 회원이 결제 정산 배송 집계와 각각 연결됨

# 이벤트 기반 아키텍처
- 주문 재고 검색 회원이 결제 정산 배송 집계와 이벤트 브로커를 통하여 연결됨
- 서비스 간 동기적 호출 패턴 : 다른 서비스로 실패 전파(크리티컬 패스가 길어져 성능 병목 원인이 되기도 함)
- 비동기 호출 패턴 (이벤트 브로커) : 내결함성 확보
- 잘 만들어진 서비스 : 일부러 오류 발생 전파력 테스트 해보기도 함

# 데이터 계층의 분리
- 데이터 계층에서의 서비스 병목 -> 목적별 데이터베이스로 분리



- 송준호 팀장(서비스 아키텍트), CJ 올리브영 (대본)
# 올리브영 현대화 여정
- 온-오프라인 연결 옴니 채널 전략 차별화된 쇼핑 경험 제공
- 올영세일(3개월마다) : 선착순 쿠폰 발급을 위한 온라인 오픈런 / 3년 연속 20% 이상 매출 성장
- 메인페이지 로딩 불가 -> 세일마다 부정적 고객 경험 : 고객 이탈율 / 매출 증가율 감소
- 메인 페이지 및 쿠폰 발급 : 우선 순위

- 온프레미스 인프라의 태생적 한계 : 확장성 문제
  - 온프레미스 리소스 제한으로 온라인몰 peak 트래픽 대응 어려움
  - 데이터베이스 병목 : single point of failure
- 아키텍처 개선 원칙 수립
  - 서비스 단위 애플리케이션 리팩토링
  - 클라우드 기반 IT 민첩성 확보
 
- 스쿼드 / poc를 통해 검증 / 리팩토링 / 목적별 데이터베이스 분리(on-going)
- 빅뱅 x -> 점진적 클라우드 이관 아키텍쳐
- 오픈소스 기반 기술 스택과 aws관리형 서비스 도입

# 서비스 단위 리팩토링 - 쿠폰 서비스
- 메인 - 쿠폰 정합성 확인 후 기록함 - 쿠폰 발급 : 워크로드 패턴(선착순 쿠폰시 DB부하 성능 병목, 확장성 제약)
- 웹서버 - 쿠폰api - aws엘라스틱캐시(유효성/정합성 체크) - MQ Brocker - 메인 (사진 참고)
- 지난 분기 대비 +120%의 선착순 쿠폰 트래픽을 소화함

# 목적별 데이터베이스 분리 - 전시영역
- 미끼 상품 로딩시 복잡한 컨텐츠 탐색 쿼리로 페이지 로딩 지연
- 트래픽 분리
- 복잡한 조건/탐색 작업 단순화 -> 응답속도 개선
- 유연한 데이터 스키마와 버저닝 활용으로 데이터 관리의 안정성 확보

# 목적별 데이터베이스 분리
- 오늘드림 실시간 매장 재고 등 : memoryDB for Redis
- 메인 db - MSK MSK Connect

# 세일 트래픽 - datadog 일원화

# future work
- 메인 DB 클라우드 이관 - 추가 확장성 확보
- 이벤트 기반 아키텍처 추가 도입
- 레거시 데이터베이스 의존성 해소





 


