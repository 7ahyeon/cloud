
- 전유성 솔루션즈 아키텍트, AWS
# 샛별 배송 컬리, 완전 관리형 데이터베이스로 빠르고 안전한 결제 서비스 구축기 (레벨 200)
- 컬리는 천만 고객의 고객 경험 개선을 위해 샛별 배송 마감 1분 전까지 빠르고 안전한 결제 서비스 제공이 필요했고, 
- 이를 위해 Agile한 문화와 완전관리형 데이터베이스를 활용해 간편 결제 서비스를 구축하였습니다. 이 세션에서는 컬리페이가 어떻게 AWS 관리형 데이터베이스 서비스로 구축 시간을 단축하였는지,
- 그리고 컬리페이가 목표로 하는 AWS를 활용한 데이터 플랫폼에 대해서도 알아보도록 하겠습니다.

# 페이먼트의 이해와 데이터 관리
- 페이먼트(간편 결제) : 카드나 계좌를 등록해놓고 인증 없이 결제할 수 있는 서비스
- eCommerce : 각각의 페이먼트 서비스 제공중
- 페이먼트 구축시 효과
  - 수수료 절감 : 페이먼트 업체와 pg사에 제공하는 수수료를 절감(1-2%)
  - 락인 효과
  - 데이터 분석
- 페이먼트 애플리케이션의 현대적 모범 사례 (컬리 페이 예시) 
  - 느슨한 연결 : 마이크로 서비스, 비동기 통신, 이벤트 기반 처리 (shell lib.pattern / amazon EKS / MSK)
  - 헤드리스 커머스 : 프론트/백 엔드 분리
  - 클라우드 네이티브 : 컨테이너와 서버리스 연산자원 활용
  - 민첩성 : 애자일 접근의 설계 및 접근 가능
  - 목적별 데이터베이스 : 의존성 해소 및 목적 특화
- 컬리 : 애자일 : 스쿼드(조직의 가장 작은 단위)

# 목적별 데이터베이스 포트폴리오
- Relational : aurora / RDS
- Key-value

# 클라우드 데이터베이스 관리 시스템 부문 매직 쿼드런트
- x축 y축

# RDS 
- aurora (mySQL/postgreSQL)
- MySQL, MariaDB, Postgre

- 손쉬운 관리
- 가용성 및 내구성
- 성능 및 확장성
- 보안 및 컴플라이언스
- AZ : 다른 데이터 센터

# 관리형 데이터베이스로 혁신 가속화 (인프라 관리가 아닌 액 혁신 및 구축에 시간 투자)
- 사용자 책임 - 데이터베이스 관리 - aws 책임

# 데이터베이스 업그레이드 - 전통적인 방법
- In-place database updates
- 장점
  - 간단함: 원클릭 관리형 워크플로
- 단점
  - 프로덕션 시스템의 다운타임
  - 예측할 수 없는 지속 시간
- Staging environment with cutover
- 장점
 - 안전함 : 더 높은 수준의 제어
 - 빠름 : 워크로드에 따른 짧은 컷오버 시간
- 단점
  - 상당한 계획/오케스트레이션 필요
  - DB end point가 변경됨 (배포 변경해야함)
 
# AWS RDS 그린/블루
- 배포 블루(유지 시 롤백환경으로 재사용 가능)-중간-그린
- DB end point 변경 없음!


 
- 양재호 데브옵스그룹 엔지니어, 컬리페이
# 컬리페이
- 소개, 여정, 23 도전, 데이터 중심 아키텍처, 향후 계획
- 소개
  - 23/04/10 런칭 - 일반, 간편 결제 오픈 및 그외 결제 서비스 오픈
- 여정
  - 21.9.(인수병합-pg라이센스) - 결제서비스 - 카드 간편결제 - 결제서비스 현대화 - 선불 전자지급수단 라이센스 - 컬리상품권/캐시
  - 마이그레이션 : 쿠버네티스 환경으로 무중단 이관
- 23 도전 : 고객 경험 혁신
  - 편리한 결제 경험
    - 간편결제 : 회원인증-결제
    - 상품권/캐시 : 충전/선물 및 사용
  - 안전한 결제 경험(보안)
    - 서버 접근 제어
    - 데이터 보안
    - 네트워크 보안(전송간 암호화)
    - 접근 제어(사용자 계정 인증 인가)
- 조직구조 변경 : 애자일 : DevOps
  - 스쿼드 : 기획자-디자이너-개발자-엔지니어
- 모놀리-분산환경
  - 회원 도메인 - 여러 트랜잭션에서 기준이 되는 데이터 필요 및 참조 데이터 다수
  - 포인트 도메인 - 여러 서비스에서 발생
  - 트랜잭션 발생시 데이터 정합성 보장 및 효율적인 이동 고려
  - 별도의 롤백 처리(의존성 저하) : 오케스트레이터 : 각 도메인의 트랜잭션 관리 : 3번 에러 (비동기 - 배치프로그램으로 3번만 롤백)
- 데이터 오너쉽 : 데이터가 생산되는 프로덕트(컬리카드) <-> 데이터를 사용하는 프로덕트(포인트)
  - 포인트 모든 오너쉽 x api x (의존성 발생)
  - Amazon MSK (비동기 처리) - catalog 사용
  - 타 도메인 데이터 필요시 요청-응답(가공된 데이터) (데이터 흐름의 투명한 관리/주체적인 데이터 생산과 사용)
- 향후 계획
  - 데이터 메쉬 (MSA확장)












